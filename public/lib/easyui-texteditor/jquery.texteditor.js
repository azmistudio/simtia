!function(t){function e(e){var i=t.data(e,"texteditor").options;if(i.selectedRange=null,window.getSelection){var o=window.getSelection();if(o.getRangeAt&&o.rangeCount){var n=(l=o.getRangeAt(0)).commonAncestorContainer.parentNode;t(n).closest(".texteditor")[0]==t(e).parent()[0]&&(i.selectedRange=l)}}else if(document.selection&&document.selection.createRange){var l;n=(l=document.selection.createRange()).parentElement();t(n).closest(".texteditor")[0]==t(e).parent()[0]&&(i.selectedRange=l)}}function i(e){var i=t.data(e,"texteditor").options;i.dlgToolbar.find(".l-btn").each(function(){var e=t(this).attr("cmd");document.queryCommandState(e)?t(this).linkbutton("select"):t(this).linkbutton("unselect")}),i.dlgToolbar.find(".combobox-f").each(function(){var e=t(this).attr("cmd"),i=String(document.queryCommandValue(e)||"");i=i.replace(/['"]/g,"").toLowerCase();var o=t(this).combo("options"),n=o.onChange;o.onChange=function(){};var l=t(this).combobox("getData");t.easyui.indexOfArray(l,o.valueField,i)>=0?t(this).combobox("setValue",i):t(this).combobox("clear"),o.onChange=n})}function o(e){var i=t(e).menubutton("options");i.menu||(i.menu=t('<div class="menu-content texteditor-color"></div>')),i.menu.menu({onShow:function(){if(t(this).is(":empty"))for(var e=["0,0,0","68,68,68","102,102,102","153,153,153","204,204,204","238,238,238","243,243,243","255,255,255","244,204,204","252,229,205","255,242,204","217,234,211","208,224,227","207,226,243","217,210,233","234,209,220","234,153,153","249,203,156","255,229,153","182,215,168","162,196,201","159,197,232","180,167,214","213,166,189","224,102,102","246,178,107","255,217,102","147,196,125","118,165,175","111,168,220","142,124,195","194,123,160","204,0,0","230,145,56","241,194,50","106,168,79","69,129,142","61,133,198","103,78,167","166,77,121","153,0,0","180,95,6","191,144,0","56,118,29","19,79,92","11,83,148","53,28,117","116,27,71","102,0,0","120,63,4","127,96,0","39,78,19","12,52,61","7,55,99","32,18,77","76,17,48"],i=0;i<e.length;i++){t('<a class="texteditor-colorcell"></a>').appendTo(this).css("backgroundColor","rgb("+e[i]+")")}}}),i.menu.bind("click",function(o){if(t(o.target).hasClass("texteditor-colorcell")){var n=t(o.target).css("backgroundColor");i.onClick.call(e,n),i.menu.menu("hide")}}),t(e).menubutton({menu:i.menu})}function n(e,i){i?(t(e).dialog("dialog").addClass("texteditor-disabled"),t(e).removeAttr("contenteditable"),t(e).next().attr("disabled","disabled")):(t(e).dialog("dialog").removeClass("texteditor-disabled"),t(e).attr("contenteditable",!0),t(e).next().removeAttr("disabled"))}t.fn.texteditor=function(o,n){if("string"==typeof o){var l=t.fn.texteditor.methods[o];return l?l(this,n):this.dialog(o,n)}return o=o||{},this.each(function(){var n=t.data(this,"texteditor");n?t.extend(n.options,o):n=t.data(this,"texteditor",{options:t.extend({},t.fn.texteditor.defaults,t.fn.texteditor.parseOptions(this),o)}),function(o){var n=t.data(o,"texteditor").options;t(n.dlgToolbar).panel("clear").remove(),n.dlgToolbar=t("<div></div>");for(var l=0;l<n.toolbar.length;l++){var a=n.toolbar[l];if("-"==a)t('<span class="dialog-tool-separator"></span>').appendTo(n.dlgToolbar);else{var r=n.commands[a];if(r){r.type=r.type||"linkbutton",r.plain=r.plain||!0;var d=t('<a href="javascript:;"></a>').appendTo(n.dlgToolbar);d.attr("cmd",a),d[r.type](r),r.onInit&&r.onInit.call(d[0])}}}t(o).dialog(t.extend({},n,{toolbar:n.dlgToolbar,onOpen:function(){t(this).dialog("dialog").css({position:""}),n.onOpen.call(this)}})),t(o).attr("contenteditable",!0);var s=t(o).dialog("dialog").children(".texteditor-value");s.length||(s=t('<textarea class="texteditor-value" style="display:none"></textarea>').insertAfter(o)),s.attr("name",n.name||t(o).attr("name")),t(o).unbind(".texteditor").bind("blur.texteditor",function(e){s.val(t(o).html())}),t(o).dialog("dialog").unbind(".texteditor").bind("mouseup.texteditor keyup.texteditor",function(){e(o),i(o)}),s.val(t(o).html())}(this)})},t.fn.texteditor.methods={options:function(t){return t.data("texteditor").options},execCommand:function(o,n){return o.each(function(){var o=n.split(" "),l=o.shift();!function(e){var i=t.data(e,"texteditor").options.selectedRange;if(window.getSelection){var o=window.getSelection();o.removeAllRanges(),i&&o.addRange(i)}else document.selection&&(document.selection.empty(),i&&i.select&&i.select())}(this),document.execCommand(l,!1,o.join(" ")||null),i(this),e(this)})},getEditor:function(t){return t.closest(".texteditor").children(".texteditor-body")},insertContent:function(e,i){return e.each(function(){!function(e,i){var o=t.data(e,"texteditor").options;o.selectedRange&&(window.getSelection?(o.selectedRange.collapse(!1),o.selectedRange.insertNode(t(i)[0])):document.selection&&o.selectedRange.select&&(o.selectedRange.collapse(!1),o.selectedRange.pasteHTML(t(i)[0])))}(this,i),t(this).dialog("dialog").children(".texteditor-value").val(t(this).html())})},getInsertDialog:function(e,i){return function(e,i){var o=t.data(e,"texteditor").options;o.dlg||(o.dlg=t("<div></div>").appendTo("body").dialog({modal:!0,border:"thin",buttons:[{text:"Ok",width:80,handler:function(){i.callback&&i.callback.call(o.dlg[0])}},{text:"Cancel",width:80,handler:function(){o.dlg.dialog("close")}}]}));var n=o.dlg;return i.content&&n.html(i.content),n.dialog("setTitle",i.title||"Insert"),n.dialog("resize",{width:i.width||400,height:i.height||"auto"}),n.dialog("center"),n}(e[0],i)},destroy:function(e){return e.each(function(){var e=t(this).texteditor("options");t(e.dlgToolbar).panel("clear"),t(this).dialog("destroy")})},getValue:function(t){return t.dialog("dialog").children(".texteditor-value").val()},setValue:function(e,i){return e.each(function(){t(this).html(i),t(this).dialog("dialog").children(".texteditor-value").val(t(this).html())})},disable:function(t){return t.each(function(){n(this,!0)})},enable:function(t){return t.each(function(){n(this,!1)})},readonly:function(e,i){return e.each(function(){!function(e,i){null==i||i?(t(e).dialog("dialog").addClass("texteditor-readonly"),t(e).removeAttr("contenteditable")):(t(e).dialog("dialog").removeClass("texteditor-readonly"),t(e).attr("contenteditable",!0))}(this,i)})}},t.fn.texteditor.parseOptions=function(e){return t.extend({},t.fn.dialog.parseOptions(e),{})},t.fn.texteditor.defaults=t.extend({},t.fn.dialog.defaults,{title:null,cls:"texteditor",bodyCls:"texteditor-body",draggable:!1,shadow:!1,closable:!1,inline:!0,border:"thin",name:"",toolbar:["bold","italic","strikethrough","underline","-","justifyleft","justifycenter","justifyright","justifyfull","-","insertorderedlist","insertunorderedlist","outdent","indent","-","insertimage","insertlink","-","forecolor","backcolor","-","formatblock","fontname","fontsize"],commands:{bold:{type:"linkbutton",iconCls:"icon-bold",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","bold")}},italic:{type:"linkbutton",iconCls:"icon-italic",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","italic")}},strikethrough:{type:"linkbutton",iconCls:"icon-strikethrough",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","strikethrough")}},underline:{type:"linkbutton",iconCls:"icon-underline",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","underline")}},justifyleft:{type:"linkbutton",iconCls:"icon-justifyleft",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","justifyleft")}},justifycenter:{type:"linkbutton",iconCls:"icon-justifycenter",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","justifycenter")}},justifyright:{type:"linkbutton",iconCls:"icon-justifyright",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","justifyright")}},justifyfull:{type:"linkbutton",iconCls:"icon-justifyfull",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","justifyfull")}},insertorderedlist:{type:"linkbutton",iconCls:"icon-insertorderedlist",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","insertorderedlist")}},insertunorderedlist:{type:"linkbutton",iconCls:"icon-insertunorderedlist",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","insertunorderedlist")}},outdent:{type:"linkbutton",iconCls:"icon-outdent",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","outdent")}},indent:{type:"linkbutton",iconCls:"icon-indent",onClick:function(){t(this).texteditor("getEditor").texteditor("execCommand","indent")}},forecolor:{type:"menubutton",iconCls:"icon-forecolor",hasDownArrow:!1,onInit:function(){o(this)},onClick:function(e){t(this).texteditor("getEditor").texteditor("execCommand","forecolor "+e)}},backcolor:{type:"menubutton",iconCls:"icon-backcolor",hasDownArrow:!1,onInit:function(){o(this)},onClick:function(e){t(this).texteditor("getEditor").texteditor("execCommand","backcolor "+e)}},formatblock:{type:"combobox",width:120,prompt:"Font Format",editable:!1,panelHeight:"auto",data:[{value:"p",text:"p"},{value:"pre",text:"pre"},{value:"h6",text:"h6"},{value:"h5",text:"h5"},{value:"h4",text:"h4"},{value:"h3",text:"h3"},{value:"h2",text:"h2"},{value:"h1",text:"h1"}],formatter:function(t){return"<"+t.value+' style="margin:0;padding:0">'+t.text+"</"+t.value+">"},onChange:function(e){t(this).texteditor("getEditor").texteditor("execCommand","formatblock "+e)}},fontname:{type:"combobox",width:120,prompt:"Font Family",editable:!1,panelHeight:"auto",data:[{value:"arial",text:"Arial"},{value:"comic sans ms",text:"Comic Sans"},{value:"courier new",text:"Courier New"},{value:"georgia",text:"Georgia"},{value:"helvetica",text:"Helvetica"},{value:"impact",text:"Impact"},{value:"times new roman",text:"Times"},{value:"trebuchet ms",text:"Trebuchet"},{value:"verdana",text:"Verdana"}],formatter:function(t){return'<font face="'+t.value+'">'+t.text+"</font>"},onChange:function(e){t(this).texteditor("getEditor").texteditor("execCommand","fontname "+e)}},fontsize:{type:"combobox",width:120,prompt:"Font Size",editable:!1,panelHeight:"auto",data:[{value:1,text:"Size 1"},{value:2,text:"Size 2"},{value:3,text:"Size 3"},{value:4,text:"Size 4"},{value:5,text:"Size 5"},{value:6,text:"Size 6"}],formatter:function(t){return'<font size="'+t.value+'">'+t.text+"</font>"},onChange:function(e){t(this).texteditor("getEditor").texteditor("execCommand","fontsize "+e)}},insertimage:{type:"linkbutton",iconCls:"icon-image",onClick:function(){var e=t(this).texteditor("getEditor"),i=e.texteditor("getInsertDialog",{title:"Insert Image",content:'<div style="padding:40px 30px 40px 20px"><div style="margin-bottom:20px"><input class="easyui-textbox img-src" label="Source:" labelAlign="right" style="width:100%"></div><div style="margin-bottom:20px"><input class="easyui-textbox img-alt" label="Description:" labelAlign="right" style="width:100%"></div><div style="margin-bottom:20px"><input class="easyui-numberbox img-width" label="Width:" labelAlign="right" style="width:50%"><input class="easyui-numberbox img-height" label="Height:" labelAlign="right" style="width:50%"></div></div>',callback:function(){var i=t(this).find(".img-src").textbox("getValue"),o=t(this).find(".img-alt").textbox("getValue"),n=t(this).find(".img-width").numberbox("getValue"),l=t(this).find(".img-height").numberbox("getValue"),a="";n&&(a+="width:"+n+"px;"),l&&(a+="height:"+l+"px;");var r='<img src="'+i+'" alt="'+o+'"'+(a?' style="'+a+'"':"")+">";e.texteditor("insertContent",r),t(this).dialog("close")}});t.parser.parse(i),i.dialog("open").dialog("resize").find(".img-src").textbox("textbox").focus()}},insertlink:{type:"linkbutton",iconCls:"icon-link",onClick:function(){var e=t(this).texteditor("getEditor"),i=e.texteditor("getInsertDialog",{title:"Insert Link",content:'<div style="padding:40px 50px 40px 20px"><div style="margin-bottom:20px"><input class="easyui-textbox link-url" label="Url:" labelAlign="right" validType="url" style="width:100%"></div><div style="margin-bottom:20px"><input class="easyui-textbox link-text" label="Text:" labelAlign="right" style="width:100%"></div><div style="margin-bottom:20px"><input class="easyui-textbox link-title" label="Title:" labelAlign="right" style="width:100%"></div><div style="margin-bottom:20px"><input class="easyui-combobox link-target" label="Target:" labelAlign="right" panelHeight="auto" data-options="editable:false,data:[{value:\'\',text:\'None\'},{value:\'_blank\',text:\'New Window\'}]" style="width:100%"></div></div>',callback:function(){var i=t(this).find(".link-url").textbox("getValue"),o=t(this).find(".link-text").textbox("getValue")||i,n=t(this).find(".link-title").textbox("getValue"),l=t(this).find(".link-target").combobox("getValue"),a='<a href="'+i+'"'+(n?' title="'+n+'"':"")+(l?' target="'+l+'"':"")+">"+o+"</a>";e.texteditor("insertContent",a),t(this).dialog("close")}});t.parser.parse(i),i.dialog("open").dialog("resize").find(".link-url").textbox("textbox").focus()}}}}),t.parser.plugins.push("texteditor")}(jQuery);